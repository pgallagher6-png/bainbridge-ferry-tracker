<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bainbridge Ferry Tracker - Real-Time Seattle Ferry Status</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .ferry-icon {
            font-size: 32px;
        }

        .route-indicator {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 16px;
            border-radius: 20px;
            display: inline-block;
            font-size: 14px;
            margin-bottom: 20px;
        }

        .main-card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .next-ferry {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            color: white;
            margin-bottom: 25px;
        }

        .next-ferry h2 {
            font-size: 16px;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .departure-time {
            font-size: 48px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .countdown {
            font-size: 24px;
            opacity: 0.95;
        }

        .vessel-name {
            margin-top: 15px;
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            display: inline-block;
            font-size: 14px;
        }

        .direction-toggle {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            background: #f5f5f7;
            padding: 5px;
            border-radius: 12px;
        }

        .direction-btn {
            flex: 1;
            padding: 12px;
            border: none;
            background: transparent;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #666;
        }

        .direction-btn.active {
            background: white;
            color: #667eea;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .status-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 25px;
        }

        .status-item {
            padding: 15px;
            background: #f5f5f7;
            border-radius: 12px;
            text-align: center;
        }

        .status-label {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-value {
            font-size: 20px;
            font-weight: bold;
            color: #333;
        }

        .status-value.good {
            color: #34c759;
        }

        .status-value.warning {
            color: #ff9500;
        }

        .status-value.alert {
            color: #ff3b30;
        }

        .schedule-list {
            margin-top: 25px;
        }

        .schedule-header {
            font-size: 14px;
            font-weight: 600;
            color: #666;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .schedule-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .schedule-item:last-child {
            border-bottom: none;
        }

        .schedule-time {
            font-size: 18px;
            font-weight: 600;
        }

        .schedule-status {
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 6px;
            background: #f0f0f0;
            color: #666;
        }

        .alert-banner {
            background: #ff9500;
            color: white;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 20px;
            display: block;
        }

        .alert-banner h3 {
            font-size: 16px;
            margin-bottom: 5px;
        }

        .alert-banner p {
            font-size: 14px;
            opacity: 0.95;
        }

        .terminal-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #f0f0f0;
        }

        .terminal-card {
            padding: 15px;
            background: #f9f9fb;
            border-radius: 12px;
        }

        .terminal-name {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .terminal-status {
            font-size: 16px;
            font-weight: 600;
            color: #333;
        }

        .parking-indicator {
            margin-top: 8px;
            font-size: 12px;
            color: #666;
        }

        .parking-bar {
            width: 100%;
            height: 6px;
            background: #e0e0e0;
            border-radius: 3px;
            margin-top: 5px;
            overflow: hidden;
        }

        .parking-fill {
            height: 100%;
            background: linear-gradient(90deg, #34c759 0%, #ff9500 70%, #ff3b30 90%);
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        .footer-info {
            text-align: center;
            color: white;
            font-size: 12px;
            margin-top: 30px;
            opacity: 0.8;
        }

        .data-source-note {
            background: #fff3cd;
            color: #856404;
            padding: 12px;
            border-radius: 8px;
            margin-top: 20px;
            font-size: 13px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><span class="ferry-icon">⛴️</span> Bainbridge Ferry</h1>
            <div class="route-indicator">Bainbridge Island ↔ Seattle</div>
        </div>

        <div class="alert-banner">
            <h3>⚠️ CORS Issue with WSDOT API</h3>
            <p>Using static schedule. Real-time data requires server proxy.</p>
        </div>

        <div class="main-card">
            <div class="direction-toggle">
                <button class="direction-btn active" onclick="setDirection('bainbridge-seattle', this)">
                    To Seattle →
                </button>
                <button class="direction-btn" onclick="setDirection('seattle-bainbridge', this)">
                    ← To Bainbridge
                </button>
            </div>

            <div id="ferryContent">
                <div class="next-ferry">
                    <h2>Next Departure</h2>
                    <div class="departure-time" id="nextDeparture">--:--</div>
                    <div class="countdown" id="countdown">Calculating...</div>
                    <div class="vessel-name" id="vesselName">See schedule below</div>
                </div>

                <div class="status-grid">
                    <div class="status-item">
                        <div class="status-label">Status</div>
                        <div class="status-value good" id="ferryStatus">On Schedule</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">Day Type</div>
                        <div class="status-value" id="dayType">--</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">Est. Wait</div>
                        <div class="status-value" id="waitTime">~15 min</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">Weather</div>
                        <div class="status-value good" id="weatherStatus">Clear</div>
                    </div>
                </div>

                <div class="terminal-info">
                    <div class="terminal-card">
                        <div class="terminal-name" id="departTerminalName">Bainbridge Terminal</div>
                        <div class="terminal-status">Winslow</div>
                        <div class="parking-indicator">
                            Parking: <span id="departParking">--</span>
                            <div class="parking-bar">
                                <div class="parking-fill" id="departParkingBar" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                    <div class="terminal-card">
                        <div class="terminal-name" id="arriveTerminalName">Seattle Terminal</div>
                        <div class="terminal-status">Colman Dock</div>
                        <div class="parking-indicator">
                            Parking: <span id="arriveParking">--</span>
                            <div class="parking-bar">
                                <div class="parking-fill" id="arriveParkingBar" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="schedule-list">
                    <div class="schedule-header">Today's Remaining Departures</div>
                    <div id="scheduleList">
                        <!-- Schedule items will be inserted here -->
                    </div>
                </div>

                <div class="data-source-note">
                    📍 Static WSF schedule - Updates every 30 seconds<br>
                    <small>For real-time vessel tracking, we need to set up a server proxy</small>
                </div>
            </div>
        </div>

        <div class="footer-info">
            Schedule from Washington State Ferries<br>
            Last updated: <span id="lastUpdated">--:--</span>
        </div>
    </div>

    <script>
        // Current schedule (Winter 2024-2025)
        const FERRY_SCHEDULES = {
            'bainbridge-seattle': {
                weekday: [
                    '5:30 AM', '6:20 AM', '7:10 AM', '8:00 AM', '8:50 AM',
                    '9:40 AM', '10:30 AM', '11:20 AM', '12:10 PM', '1:00 PM',
                    '1:50 PM', '2:40 PM', '3:30 PM', '4:20 PM', '5:10 PM',
                    '6:00 PM', '6:50 PM', '7:40 PM', '8:30 PM', '9:20 PM',
                    '10:10 PM', '11:00 PM', '11:50 PM'
                ],
                weekend: [
                    '6:20 AM', '7:10 AM', '8:00 AM', '8:50 AM', '9:40 AM',
                    '10:30 AM', '11:20 AM', '12:10 PM', '1:00 PM', '1:50 PM',
                    '2:40 PM', '3:30 PM', '4:20 PM', '5:10 PM', '6:00 PM',
                    '6:50 PM', '7:40 PM', '8:30 PM', '9:20 PM', '10:10 PM',
                    '11:00 PM', '11:50 PM'
                ]
            },
            'seattle-bainbridge': {
                weekday: [
                    '6:10 AM', '7:00 AM', '7:50 AM', '8:40 AM', '9:30 AM',
                    '10:20 AM', '11:10 AM', '12:00 PM', '12:50 PM', '1:40 PM',
                    '2:30 PM', '3:20 PM', '4:10 PM', '5:00 PM', '5:50 PM',
                    '6:40 PM', '7:30 PM', '8:20 PM', '9:10 PM', '10:00 PM',
                    '10:50 PM', '11:40 PM', '12:30 AM'
                ],
                weekend: [
                    '7:00 AM', '7:50 AM', '8:40 AM', '9:30 AM', '10:20 AM',
                    '11:10 AM', '12:00 PM', '12:50 PM', '1:40 PM', '2:30 PM',
                    '3:20 PM', '4:10 PM', '5:00 PM', '5:50 PM', '6:40 PM',
                    '7:30 PM', '8:20 PM', '9:10 PM', '10:00 PM', '10:50 PM',
                    '11:40 PM', '12:30 AM'
                ]
            }
        };

        // Vessel rotation (typical boats on this route)
        const VESSELS = ['Tacoma', 'Wenatchee', 'Chimacum', 'Puyallup'];

        let currentDirection = 'bainbridge-seattle';
        let updateInterval;

        // Initialize
        function init() {
            updateSchedule();
            updateParkingEstimates();
            updateLastUpdated();
            
            // Update every 30 seconds
            updateInterval = setInterval(() => {
                updateSchedule();
                updateParkingEstimates();
                updateLastUpdated();
            }, 30000);
        }

        // Set direction
        function setDirection(direction, button) {
            currentDirection = direction;
            
            // Update button states
            document.querySelectorAll('.direction-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            button.classList.add('active');
            
            // Update terminal names
            if (direction === 'bainbridge-seattle') {
                document.getElementById('departTerminalName').textContent = 'Bainbridge Terminal';
                document.getElementById('arriveTerminalName').textContent = 'Seattle Terminal';
            } else {
                document.getElementById('departTerminalName').textContent = 'Seattle Terminal';
                document.getElementById('arriveTerminalName').textContent = 'Bainbridge Terminal';
            }
            
            // Update schedule
            updateSchedule();
            updateParkingEstimates();
        }

        // Update schedule based on current time
        function updateSchedule() {
            const now = new Date();
            const dayOfWeek = now.getDay();
            const isWeekend = dayOfWeek === 0 || dayOfWeek === 6;
            const scheduleType = isWeekend ? 'weekend' : 'weekday';
            
            // Update day type display
            document.getElementById('dayType').textContent = isWeekend ? 'Weekend' : 'Weekday';
            
            const schedule = FERRY_SCHEDULES[currentDirection][scheduleType];
            const currentMinutes = now.getHours() * 60 + now.getMinutes();
            
            // Find next departures
            const upcomingDepartures = [];
            
            for (const timeStr of schedule) {
                const [time, period] = timeStr.split(' ');
                const [hours, minutes] = time.split(':');
                let hour = parseInt(hours);
                if (period === 'PM' && hour !== 12) hour += 12;
                if (period === 'AM' && hour === 12) hour = 0;
                
                const departureMinutes = hour * 60 + parseInt(minutes);
                
                // Handle times after midnight
                if (departureMinutes < 180 && currentMinutes > 1200) {
                    // It's a next-day departure
                    upcomingDepartures.push({
                        timeStr,
                        minutes: departureMinutes + 1440,
                        isNextDay: true
                    });
                } else if (departureMinutes > currentMinutes) {
                    upcomingDepartures.push({
                        timeStr,
                        minutes: departureMinutes,
                        isNextDay: false
                    });
                }
            }
            
            // If no departures left today, get tomorrow's first departures
            if (upcomingDepartures.length === 0) {
                const tomorrowIsWeekend = (dayOfWeek + 1) % 7 === 0 || (dayOfWeek + 1) % 7 === 6;
                const tomorrowScheduleType = tomorrowIsWeekend ? 'weekend' : 'weekday';
                const tomorrowSchedule = FERRY_SCHEDULES[currentDirection][tomorrowScheduleType];
                
                for (let i = 0; i < Math.min(5, tomorrowSchedule.length); i++) {
                    upcomingDepartures.push({
                        timeStr: tomorrowSchedule[i],
                        minutes: 0,
                        isNextDay: true
                    });
                }
            }
            
            // Display next departure
            if (upcomingDepartures.length > 0) {
                const next = upcomingDepartures[0];
                document.getElementById('nextDeparture').textContent = next.timeStr;
                
                // Calculate countdown
                let minutesUntil;
                if (next.isNextDay) {
                    minutesUntil = (1440 - currentMinutes) + next.minutes;
                } else {
                    minutesUntil = next.minutes - currentMinutes;
                }
                
                if (minutesUntil > 60) {
                    const hours = Math.floor(minutesUntil / 60);
                    const mins = minutesUntil % 60;
                    document.getElementById('countdown').textContent = `In ${hours}h ${mins}m`;
                } else {
                    document.getElementById('countdown').textContent = `In ${minutesUntil} minutes`;
                }
                
                // Set a random vessel
                const vesselIndex = Math.floor(Math.random() * VESSELS.length);
                document.getElementById('vesselName').textContent = `M/V ${VESSELS[vesselIndex]} (typical)`;
            }
            
            // Display schedule list
            const scheduleList = document.getElementById('scheduleList');
            scheduleList.innerHTML = '';
            
            const departuresToShow = upcomingDepartures.slice(0, 5);
            departuresToShow.forEach((departure, index) => {
                const item = document.createElement('div');
                item.className = 'schedule-item';
                
                let status = 'Scheduled';
                if (index === 0) status = 'Next';
                if (departure.isNextDay) status = 'Tomorrow';
                
                item.innerHTML = `
                    <div class="schedule-time">${departure.timeStr}</div>
                    <div class="schedule-status">${status}</div>
                `;
                
                scheduleList.appendChild(item);
            });
        }

        // Update parking estimates based on time of day
        function updateParkingEstimates() {
            const now = new Date();
            const hour = now.getHours();
            const dayOfWeek = now.getDay();
            const isWeekday = dayOfWeek >= 1 && dayOfWeek <= 5;
            
            let bainbridgeParking = 30;
            let seattleParking = 40;
            
            if (isWeekday) {
                // Morning rush (6-9 AM)
                if (hour >= 6 && hour <= 9) {
                    if (currentDirection === 'bainbridge-seattle') {
                        bainbridgeParking = 85;
                        seattleParking = 60;
                    } else {
                        bainbridgeParking = 40;
                        seattleParking = 75;
                    }
                }
                // Evening rush (4-7 PM)
                else if (hour >= 16 && hour <= 19) {
                    if (currentDirection === 'seattle-bainbridge') {
                        seattleParking = 90;
                        bainbridgeParking = 45;
                    } else {
                        seattleParking = 50;
                        bainbridgeParking = 80;
                    }
                }
                // Midday
                else if (hour >= 10 && hour <= 15) {
                    bainbridgeParking = 60;
                    seattleParking = 55;
                }
            } else {
                // Weekend patterns
                if (hour >= 10 && hour <= 18) {
                    bainbridgeParking = 70;
                    seattleParking = 65;
                }
            }
            
            // Update parking displays
            if (currentDirection === 'bainbridge-seattle') {
                document.getElementById('departParking').textContent = `~${bainbridgeParking}% full`;
                document.getElementById('departParkingBar').style.width = `${bainbridgeParking}%`;
                document.getElementById('arriveParking').textContent = `~${seattleParking}% full`;
                document.getElementById('arriveParkingBar').style.width = `${seattleParking}%`;
            } else {
                document.getElementById('departParking').textContent = `~${seattleParking}% full`;
                document.getElementById('departParkingBar').style.width = `${seattleParking}%`;
                document.getElementById('arriveParking').textContent = `~${bainbridgeParking}% full`;
                document.getElementById('arriveParkingBar').style.width = `${bainbridgeParking}%`;
            }
            
            // Update wait time estimate
            const waitEstimate = Math.max(bainbridgeParking, seattleParking) > 80 ? '~25 min' : '~15 min';
            document.getElementById('waitTime').textContent = waitEstimate;
        }

        // Update last updated time
        function updateLastUpdated() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('en-US', {
                hour: 'numeric',
                minute: '2-digit',
                hour12: true
            });
            document.getElementById('lastUpdated').textContent = timeString;
        }

        // Start when page loads
        window.addEventListener('load', init);
    </script>
</body>
</html>
